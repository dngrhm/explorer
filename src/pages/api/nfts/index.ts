const metadata = {
  'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.stacculents': {
    contract: 'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.stacculents',
    ipfsUrl: 'ipfs://ipfs/QmNm8SPqjmbrjm1JWmim3z5JRkmaavTEw6trT4pyw2kj8z/$TOKEN_ID.json',
  },
  'SP3D6PV2ACBPEKYJTCMH7HEN02KP87QSP8KTEH335.megapont-ape-club-nft': {
    contract: 'SP3D6PV2ACBPEKYJTCMH7HEN02KP87QSP8KTEH335.megapont-ape-club-nft',
    ipfsUrl: 'ipfs://ipfs/QmfEeoHahEqpdC2xDAEGEkzzWc1Ms99FbVz5j79PsDUpSf/{id}',
  },
  'SPJJYJVZ4H7B34GG8D3SSN70WVWDYSHCC9E9ZV4V.bitcoin-toadz': {
    contract: 'SPJJYJVZ4H7B34GG8D3SSN70WVWDYSHCC9E9ZV4V.bitcoin-toadz',
    ipfsUrl: 'ipfs://ipfs/QmRt5hZo26w1VPP5gUTrnkxjef2XbbLETDxXQKVwoU6peB/json/{id}.json',
  },
  'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.wasteland-apes-nft': {
    contract: 'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.wasteland-apes-nft',
    ipfsUrl: 'ipfs://ipfs/Qmf1gSoSnQLSgG2NbubUbi8R8cuT8sx8T1ZDqcr7cgiu1X/1.json',
  },
  'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.belles-witches': {
    contract: 'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.belles-witches',
    ipfsUrl: 'ipfs://ipfs/QmUpfBNUnVUzwhbahvRTrSPrQhFnBv1VVwe9t6csCPCF53/{id}.json',
  },
  'SP3D6PV2ACBPEKYJTCMH7HEN02KP87QSP8KTEH335.megapont-robot-component-nft': {
    contract: 'SP3D6PV2ACBPEKYJTCMH7HEN02KP87QSP8KTEH335.megapont-robot-component-nft',
    ipfsUrl: 'https://api.megapont.com/components/{id}',
  },
  'SP125J1ADVYWGWB9NQRCVGKYAG73R17ZNMV17XEJ7.mutant-monkeys': {
    contract: 'SP125J1ADVYWGWB9NQRCVGKYAG73R17ZNMV17XEJ7.mutant-monkeys',
    ipfsUrl: 'https://api.byzantion.xyz/api/meta/mutant_monkeys/1.json',
  },
  'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.bitcoin-monkeys-eggs-collection': {
    contract: 'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.bitcoin-monkeys-eggs-collection',
    ipfsUrl: 'ipfs://ipfs/QmYjCAdtgUWBhTCym5GHRgiKUpFshZp7ueppPJDZbACQnW/{id}.json',
  },
  'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.bitcoin-monkeys-incubators': {
    contract: 'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.bitcoin-monkeys-incubators',
    ipfsUrl: 'ipfs://ipfs/QmeBD4J8QExMV2YWZ2s3iCXM3ztjD8PV466K9xo17SP8s6/{id}.json',
  },
  'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.steady-lads': {
    contract: 'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.steady-lads',
    ipfsUrl: 'ipfs://ipfs/QmQ1noHLEg9a6xjAbGLeUjagiMtqXK3mZscBgECZJUw5b5/1.json',
  },
  'SP3D6PV2ACBPEKYJTCMH7HEN02KP87QSP8KTEH335.megapont-robot-nft': {
    contract: 'SP3D6PV2ACBPEKYJTCMH7HEN02KP87QSP8KTEH335.megapont-robot-nft',
    ipfsUrl: 'https://api.megapont.com/robots/{id}',
  },
  'SP176ZMV706NZGDDX8VSQRGMB7QN33BBDVZ6BMNHD.project-indigo-act1': {
    contract: 'SP176ZMV706NZGDDX8VSQRGMB7QN33BBDVZ6BMNHD.project-indigo-act1',
    ipfsUrl: 'ipfs://ipfs/QmYv43A9bcyy8vAqgdBL6MFxXTMsQgFJXuC6VdM2NKM7u1/{id}',
  },
  'SPXG42Y7WDTMZF5MPV02C3AWY1VNP9FH9C23PRXH.Marbling': {
    contract: 'SPXG42Y7WDTMZF5MPV02C3AWY1VNP9FH9C23PRXH.Marbling',
    ipfsUrl: 'ipfs://ipfs/QmXmuoMt8V5YpnZr5PT4qSDoF4hX6yuL6QmW9zEyizZ9oe/1',
  },
  'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.bitcoin-monkeys-labs': {
    contract: 'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.bitcoin-monkeys-labs',
    ipfsUrl: 'ipfs://ipfs/QmWe7tBAsy7RxDbg7x4WGqX33dS9px9p4PwQYNH3YDwpkH/1.json',
  },
  'SP1CSHTKVHMMQJ7PRQRFYW6SB4QAW6SR3XY2F81PA.the-guests': {
    contract: 'SP1CSHTKVHMMQJ7PRQRFYW6SB4QAW6SR3XY2F81PA.the-guests',
    ipfsUrl: 'ipfs://ipfs/QmVummGsfXLhre2Gr27B4MUUVDvvxXSxavVgqZtYXkptYp/{id}.json',
  },
  'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.slime-components-and-minions': {
    contract: 'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.slime-components-and-minions',
    ipfsUrl: 'ipfs://ipfs/QmNRXPKHfmM3fSa4sogPakb8jngthCs6mwhKH3GEo85Ycv/{id}.json',
  },
  'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.hback-whales-nft': {
    contract: 'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.hback-whales-nft',
    ipfsUrl: 'ipfs://ipfs/Qma8dfhNd3mXBQ7G7TTTFLUMLsi9vhH6UzhFoVErdGBP7q/1.json',
  },
  'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.monkey-coin': {
    contract: 'SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S.monkey-coin',
    ipfsUrl: 'ipfs://ipfs/QmSwdoZbHmJj8LX5J3H18xzoFLRf9CSTdiUgBN9ndtDmqv/{id}.json',
  },
  'SP22GHCK5W3EK5VC1PEB3VVCBVFRQNTQXV9306QA0.bear-market-buddies': {
    contract: 'SP22GHCK5W3EK5VC1PEB3VVCBVFRQNTQXV9306QA0.bear-market-buddies',
    ipfsUrl: 'ipfs://ipfs/QmdiB1MPrUtGCu9eexBXqh1L1wrFixvFcF4qXEJm4vDfYz/json/{id}.json',
  },
  // 'SP2X0TZ59D5SZ8ACQ6YMCHHNR2ZN51Z32E2CJ173.the-explorer-guild': {
  //   contract: 'SP2X0TZ59D5SZ8ACQ6YMCHHNR2ZN51Z32E2CJ173.the-explorer-guild',
  //   ipfsUrl: 'ar://II4z2ziYyqG7-kWDa98lWGfjxRdYOx9Zdld9P_I_kzE/1.json',
  // },
  'SPVVASJ83H223TCEP8Z8SHZDFDBFXSM4EGSWCVR2.sol-townsfolk-nft': {
    contract: 'SPVVASJ83H223TCEP8Z8SHZDFDBFXSM4EGSWCVR2.sol-townsfolk-nft',
    ipfsUrl: 'ipfs://ipfs/Qmehs5qM6fBYwKB7jfqzqdJTyZUdYi4iAHKJsVcoEabpa2/{id}.json',
  },
  'SP1D3Y8A2VVD2W98VFXCG5AXRYX5PJBBEMV1YPKF1.nonnish-grafters': {
    contract: 'SP1D3Y8A2VVD2W98VFXCG5AXRYX5PJBBEMV1YPKF1.nonnish-grafters',
    ipfsUrl: 'ipfs://ipfs/QmVin9i6ZZDqNMps7XUxYxhgzY5UiRHR9ttFBJwmvYHMRA/{id}.json',
  },
  // 'SP213KNHB5QD308TEESY1ZMX1BP8EZDPG4JWD0MEA.club-100k': {
  //   contract: 'SP213KNHB5QD308TEESY1ZMX1BP8EZDPG4JWD0MEA.club-100k',
  //   ipfsUrl: 'https://bitfari.org/club-100k',
  // },
  'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.stacks-punks-v3': {
    contract: 'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.stacks-punks-v3',
    ipfsUrl: 'https://www.stackspunks.com/assets/punks.json',
  },
  // 'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.byzantion-stacks-foxes-community': {
  //   contract: 'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.byzantion-stacks-foxes-community',
  //   ipfsUrl:
  //     'ipfs://ipfs/bafybeichgxmhxtolilxdr5c6aalife6sypprplboh2uqdpjdklyglu4dsy/stacks_foxes_community/stacks_foxes_community_1_metadata.json',
  // },
  // 'SP213KNHB5QD308TEESY1ZMX1BP8EZDPG4JWD0MEA.web4': {
  //   contract: 'SP213KNHB5QD308TEESY1ZMX1BP8EZDPG4JWD0MEA.web4',
  //   ipfsUrl: 'https://api.bitfari.com/json/land/nft/way/676196016/',
  // },
  'SPZW30K9VG6YCPYV4BX4V1FT0VJ66R1Q01W9DQ1W.htl': {
    contract: 'SPZW30K9VG6YCPYV4BX4V1FT0VJ66R1Q01W9DQ1W.htl',
    ipfsUrl: 'ipfs://ipfs/QmSs1fQTrRJwSDrqmVPKVq6cgn7grAASzMHJXLKqWyqAye/{id}.json',
  },
  'SP2XJBAZXVDT2WMFY82XGPX8Q64GF45CSX66Q32G4.bitcoin-nouns': {
    contract: 'SP2XJBAZXVDT2WMFY82XGPX8Q64GF45CSX66Q32G4.bitcoin-nouns',
    ipfsUrl: 'ipfs://ipfs/Qme5GpDVN12H8ZSdQm8rUBaGQLP1ZkMw89JgLT94VsGQSH/json/{id}.json',
  },
  'SP2507VNQZC9VBXM7X7KB4SF4QJDJRSWHG4V39WPY.punk-donuts': {
    contract: 'SP2507VNQZC9VBXM7X7KB4SF4QJDJRSWHG4V39WPY.punk-donuts',
    ipfsUrl: 'ipfs://ipfs/QmfZtnMbycEfhmKWDk1hUJNWRNXKx3NbvnMd5Xr2qwJPDe',
  },
  // 'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.citadels': {
  //   contract: 'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.citadels',
  //   ipfsUrl: 'https://www.stacksart.com/assets/citadels.json',
  // },
  'SP2N3BAG4GBF8NHRPH6AY4YYH1SP6NK5TGCY7RDFA.stacks-mfers': {
    contract: 'SP2N3BAG4GBF8NHRPH6AY4YYH1SP6NK5TGCY7RDFA.stacks-mfers',
    ipfsUrl: 'ipfs://ipfs/QmbMdASbHZb5XHizZJsFPL9hdmuDgekUHH9Ya1DnuSxfHj/{id}.json',
  },
  'SP187Y7NRSG3T9Z9WTSWNEN3XRV1YSJWS81C7JKV7.easter-bunnies': {
    contract: 'SP187Y7NRSG3T9Z9WTSWNEN3XRV1YSJWS81C7JKV7.easter-bunnies',
    ipfsUrl: 'ipfs://ipfs/QmdeAiL4YDHfXjZxYRVeRTPMuG3LBknqfmcxrenRggA5Gw/json/{id}.json',
  },
  // 'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.stacks-mandala': {
  //   contract: 'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.stacks-mandala',
  //   ipfsUrl: 'https://www.stacksart.com/assets/stacks-mandala.json',
  // },
  'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.shapes': {
    contract: 'SPJW1XE278YMCEYMXB8ZFGJMH8ZVAAEDP2S2PJYG.shapes',
    ipfsUrl: 'ipfs://ipfs/QmPffbGCSzFxTdtn2oP2ivjsYnngUAUZVTdBntRmVVSVjg',
  },
  'SP1FVFX8HQZPVHS2SBBRDGB8A1G8QCXHAMQAFQV0T.hallow-heads': {
    contract: 'SP1FVFX8HQZPVHS2SBBRDGB8A1G8QCXHAMQAFQV0T.hallow-heads',
    ipfsUrl: 'ipfs://ipfs/QmbwnonvH1xxuiAffPZmcqyV3wz2X2JuXEnafrFY9vYrjC/json/{id}.json',
  },
  'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.minotauri-nft': {
    contract: 'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.minotauri-nft',
    ipfsUrl: 'ipfs://ipfs/QmedQjZzqg4qd48UawqbBtEeQZZ6N89c6zMRv3CkJXTm82/1.json',
  },
};

export function ipfsToIpfsIo(ipfsUrl: string): string {
  return ipfsUrl.replace(/(ipfs:\/\/.*)(Qm.*)/, (a, b, c) => 'https://ipfs.io/ipfs/' + c);
}

function standardiseIpfsUrl(ipfsUrl: string): string {
  const ipfsHttp = ipfsToIpfsIo(ipfsUrl);
  return ipfsHttp
    .replace('$TOKEN_ID', '{id}')
    .replace('1.json', '{id}.json')
    .replace('/(.+)1(.+).json', '{id}.json')
    .replace('/1', '/{id}.json')
    .replace(/ipfs:\/\/([^/]+)$/, (_, match) => `${match}/{id}.json`);
}

function standardise(metadata: any) {
  return Object.keys(metadata).reduce((acc, key) => {
    const item = metadata[key];
    // @ts-ignore
    acc[item.contract] = {
      contract: item.contract,
      ipfsUrl: standardiseIpfsUrl(item.ipfsUrl),
    };
    return acc;
  }, {});
}

const metadataStandard = standardise(metadata);

// @ts-ignore
export default function handler(req, res) {
  res.status(200).json(metadataStandard);
}
